DROP TABLE TMA_Requests;
DROP TABLE Items;
DROP TABLE ItemGroup;
DROP TABLE UnitOfMeasurements;
DROP TABLE Emp;
DROP TABLE Roles;


CREATE TABLE UnitOfMeasurements (
    UnitID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    UnitName VARCHAR2(255) NOT NULL,
    PRIMARY KEY (UnitName)
);

CREATE TABLE ItemGroup (
    GroupID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    GroupName VARCHAR2(255) NOT NULL,
    PRIMARY KEY (GroupName)
);

CREATE TABLE Items  (
    ItemID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    ItemName VARCHAR2(255) NOT NULL,
    ItemGroup VARCHAR2(255) NOT NULL,
    UnitOfMeasurement VARCHAR2(255) NOT NULL,
    Quantity NUMBER NOT NULL,
    PriceWithoutVAT NUMBER(10, 2) NOT NULL,
    Status VARCHAR2(255) NOT NULL,
    StorageLocation VARCHAR2(255),
    ContactPerson CLOB,
    CONSTRAINT FK_UnitOfMeasurement FOREIGN KEY (UnitOfMeasurement) REFERENCES UnitOfMeasurements (UnitName),
    CONSTRAINT FK_ItemGroup FOREIGN KEY (ItemGroup) REFERENCES ItemGroup (GroupName),
    PRIMARY KEY (ItemID)
);

CREATE TABLE Roles (
    RoleID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    RoleName VARCHAR2(255) NOT NULL,
    PRIMARY KEY (RoleName)
);

CREATE TABLE Emp(
    EmpID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    EmpName VARCHAR2(255),
    EmpRole VARCHAR2(255) NOT NULL,
    Password VARCHAR2(255) NOT NULL,
    CONSTRAINT FK_RoleID FOREIGN KEY (EmpRole) REFERENCES Roles (RoleName),
    PRIMARY KEY (EmpID)
);

CREATE TABLE TMA_Requests (
    RequestID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    EmployeeID NUMBER NOT NULL,
    ItemID NUMBER NOT NULL,
    UnitOfMeasurement VARCHAR2(255) NOT NULL,
    Quantity NUMBER NOT NULL,
    PriceWithoutVAT NUMBER(10, 2) NOT NULL,
    "COMMENT" CLOB,
    Status VARCHAR2(255) DEFAULT 'New' CHECK (Status IN ('New', 'Approved', 'Rejected')),
    CONSTRAINT FK_EmployeeName FOREIGN KEY (EmployeeID) REFERENCES Emp (EmpID),
    CONSTRAINT FK_ItemID FOREIGN KEY (ItemID) REFERENCES Items (ItemID),
    CONSTRAINT FK_UnitOfMeasurementRequest FOREIGN KEY (UnitOfMeasurement) REFERENCES UnitOfMeasurements (UnitName),
    PRIMARY KEY (RequestID)
);


INSERT INTO Roles(RoleName) VALUES ('Coordinator');
INSERT INTO Roles(RoleName) VALUES ('Employee');
INSERT INTO Roles(RoleName) VALUES ('Administrator');

INSERT INTO UnitOfMeasurements (UnitName) VALUES ('Piece');
INSERT INTO UnitOfMeasurements (UnitName) VALUES ('Kilogram');
INSERT INTO UnitOfMeasurements (UnitName) VALUES ('Liter');

INSERT INTO EMP(EmpName, EmpRole, Password) VALUES ('Scott', 'Coordinator', 'Coordinator');
INSERT INTO EMP(EmpName, EmpRole, Password) VALUES ('Blank', 'Employee', 'Employee');
INSERT INTO EMP(EmpName, EmpRole, Password) VALUES ('King', 'Administrator', 'Administrator');

INSERT INTO ItemGroup(GroupName) VALUES ('Electronics');
INSERT INTO ItemGroup(GroupName) VALUES ('Sport');
INSERT INTO ItemGroup(GroupName) VALUES ('Home');

INSERT INTO Items(ItemName, ItemGroup, UnitOfMeasurement, Quantity, PriceWithoutVAT, Status, StorageLocation, ContactPerson)
VALUES ('Telephone', 'Electronics', 'Piece', 50, 499.99, 'New', 'Street 25', 'John');
INSERT INTO Items(ItemName, ItemGroup, UnitOfMeasurement, Quantity, PriceWithoutVAT, Status, StorageLocation, ContactPerson)
VALUES ('Protein', 'Sport', 'Kilogram', 180, 79.99, 'New', 'Street 88', 'Jane');
INSERT INTO Items(ItemName, ItemGroup, UnitOfMeasurement, Quantity, PriceWithoutVAT, Status, StorageLocation, ContactPerson)
VALUES ('Aquarium water', 'Home', 'Liter', 14, 1299.99, 'New', 'Street 1', 'Dave');

INSERT INTO TMA_REQUESTS(EmployeeID, ItemID, UnitOfMeasurement, Quantity, PriceWithoutVAT, "COMMENT", Status)
VALUES (1, 2, 'Liter', 2, 159.98, 'Approve', 'Approved');
INSERT INTO TMA_REQUESTS(EmployeeID, ItemID, UnitOfMeasurement, Quantity, PriceWithoutVAT, "COMMENT", Status)
VALUES (2, 2, 'Liter', 2, 159.98, 'Added', 'New');